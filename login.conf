{
	instances = {
		identify = PostFieldReader(
			field_username = "^[\\w|0-9|-|_]+$",
			field_password = "^.{1,250}$"
		) {
			form_branch = Template(f"templates/LoginForm.html");
			successful_branch = DataReader(f"queries/GetLoginByCredentials.sql") {
				none_branch = Template(f"templates/LoginFail.html");
				single_branch = Return("identified");
			};
		};	

		registerform = Template(f"templates/RegisterForm.html");

		createaccount = DataReader(f"queries/Get Login by username.auto.sql") {
			none->DataReader(f"queries/AddLoginCredentials.sql") {
				none->Template(f"templates/RegisterFail.html");
				single->Return("done");			
			};
			single->Template(f"templates/usernamenotunique.html") {
				form->instances.registerform;
			};
		};

		create = PostFieldReader(
			field_username = "^[\\w|0-9|-|_]+$",
			field_password = "^.{8,250}$",
			field_repeatpassword = "^.{0,250}$",
			field_check = "^green$",
			maperrors = true
		) {
			username_failure->Template(f"templates/userfail.html");
			password_failure->Template(f"templates/passwordfail.html");
			check_failure->Template(f"templates/checkfail.html");
			form->instances.registerform;
			successful->Equals("password", to="repeatpassword") {
				successful->instances.createaccount;
				failure->Log("nope") {
					continue->Template(f"templates/passwordmismatch.html") {
						form->instances.registerform;
					};
				};
			};
		};
	};
}